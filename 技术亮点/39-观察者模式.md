# 39 - 观察者模式 👀

> **难度**: ⭐⭐⭐⭐ | **价值**: 🔥🔥🔥🔥 | **创新度**: ⭐⭐⭐⭐ |

---

## 📌 技术概述

观察者模式定义对象间的一对多依赖关系，当状态发生变化时，所有依赖者都会收到通知。在项目中，前端使用Zustand的状态持久化功能，当状态更新时自动同步到localStorage。

---

## 🔍 技术原理

```typescript
// 观察者：localStorage
const useAppStore = create<AppState>()(
  persist(
    (set) => ({
    currentRole: 'tourist',
    setCurrentRole: (role) => set({ currentRole: role }),
    // ...
  }),
    {
      name: 'shanxi-tourism-storage',
      partialize: (state) => ({
        sessionId: state.sessionId,
        currentRole: state.currentRole,
      })
    }
  )
);
```

---

## 💡 项目应用

**代码位置**：[frontend/src/stores/appStore.ts](../../frontend/src/stores/appStore.ts#L32-70)

---

## 📊 对比优势

| 维度 | 无观察者 | 观察者模式 |
|-----|---------|-----------|
| 数据同步 | 手动 | 自动 |
| 状态一致性 | 低 | 高 |

---

**文档版本**: v1.0
**最后更新**: 2026-01-02
**作者**: 山西文旅智能体团队
